# 任务1：CRM 额度提案/额度审核优化

## 需求原文（2025-11-29）
- 【额度审核】优化项目
  1）检测时间不完整，
  2）页面舒适度，column大小与内容一致
  3）日期格式默认当天0点到23:59:59
  4）等级要显示-不要只是数字
  5）数字格式要千分位 例子：102969.81 >> 102,969.81
  6）审核操作-只能操作一次后无法再改
  7）添加产品，默认不勾选是全产品（done）
  8）添加会员备注
  9）添加历史存提查
  10）数据时间创建时间第一条

## 当批需求拆解（2025-11-29）
1. 检测时间必填，缺失时阻止提交。
2. 列宽与字段内容对齐，主要信息完整展示。
3. 日期筛选默认当天 00:00:00 - 23:59:59。
4. 等级展示名称/标签，而非纯数字。
5. 金额字段千分位格式（例：102,969.81）。
6. 审核操作仅可执行一次，执行后不可修改。
7. 产品选择默认不勾选 = 全产品（已完成，确认沿用）。
8. 增加会员备注输入/查看能力。
9. 增加历史存提查询入口，用于审核参考。
10. 列表首列展示创建时间（时间排序依据），并展示额度类别（例：额度转出 熊猫体育->QIANYI）。

## 任务进展
| 编号 | 需求原文 | 状态 | 完成情况 |
|------|---------|------|---------|
| 1 | 检测时间不完整 | ✅ 部分完成 | 前端校验已完成,缺默认值+后端校验 |
| 2 | 页面舒适度，column大小与内容一致 | ✅ 已完成 | 列宽已调整优化 |
| 3 | 日期格式默认当天0点到23:59:59 | ✅ 已完成 | 页面加载时自动设置默认时间 |
| 4 | 等级要显示-不要只是数字 | ✅ 已完成 | 使用levelFormat格式化显示等级名称 |
| 5 | 数字格式要千分位 | ✅ 已完成 | 金额列已添加千分位格式化 |
| 6 | 审核操作-只能操作一次后无法再改 | ✅ 已完成 | 前端按钮控制+后端幂等校验 |
| 7 | 添加产品，默认不勾选是全产品 | ✅ 已完成 | 添加"全部"选项,默认选中全部产品 |
| 8 | 添加会员备注 | ✅ 已完成 | 备注功能已存在,修复字符限制128 |
| 9 | 添加历史存提查 | ❌ 未开始 | 待实现 |
| 10 | 数据时间创建时间第一条 | ❌ 未开始 | 待实现 |

**进度统计**: 已完成 7/10, 部分完成 1/10, 未开始 2/10

## 修改点（按需求编号）
1. 检测时间必填（前端+后端）
   - 前端：筛选/提审表单必填校验，默认当天 00:00:00~23:59:59；crm-vue/src/views/modules/risk/transferARM.vue、 transferARM-add-or-update.vue。
   - 后端：/api/risk/proposal/saveOrUpdate/arm 校验检测时间缺失直接报错；RiskProposalOServiceImpl.saveOrUpdateProcess。
2. 列宽与字段对齐（前端）
   - 前端：调整列表列宽与对齐，核心字段完整展示； transferARM.vue。
3. 日期默认当天（前端）
   - 前端：筛选/列表默认当天 00:00:00~23:59:59； transferARM.vue。
4. 等级显示名称/标签（前端+后端）
   - 后端：返回 levelName/标签映射；RiskProposalOServiceImpl.queryPage2、RiskProposalODao.queryList2、RiskProposalDao.xml（如需补字段）。
   - 前端：等级列用名称/标签渲染，避免纯数字； transferARM.vue。
5. 金额千分位（前端）
   - 前端：金额列千分位+两位小数格式化； transferARM.vue。
6. 审核仅一次（前端+后端）
   - 后端：基于 flag/状态幂等校验，已处理拒绝再次操作；RiskProposalOServiceImpl.saveOrUpdateProcess。
   - 前端：按钮禁用逻辑依赖 flag，防止重复点击； transferARM.vue、 transferARM-add-or-update.vue。
7. 产品默认全产品（前端，已完成）
   - 前端：保持“不选=全产品”逻辑并在 UI 提示； transferARM.vue。
8. 会员备注（前端+后端）
   - 后端：remark 字段读写，保存/查询备注；RiskProposalODao.updateOrSave 等。
   - 前端：审核页/弹窗备注输入与列表展示； transferARM-add-or-update.vue、 transferARM.vue。
9. 历史存提查询（前端+后端）
   - 前端：入口按钮/弹窗按 loginname 调用； transferARM.vue。
   - 后端：提供或复用按 loginname 的存提查询接口；相关 service/dao。
10. 创建时间首列 + 额度类别（前端+后端）
    - 前端：creditInsertTime 置于首列（固定左侧）并默认排序；新增/保留“额度类别”列显示 creditLogName； transferARM.vue。
    - 后端：确保返回 creditInsertTime、creditLogName；RiskProposalODao.queryList2、RiskProposalDao.xml。






## 需求原文（下一批，YYYY-MM-DD）
- 【在此填写原文】
  1）
  2）
  3）
  4）
  5）

## 当批需求拆解（同上日期）
1. 
2. 
3. 

## 修改点（按需求编号）
1. （前端/后端）
   - 前端：
   - 后端：
2. （前端/后端）
   - 前端：
   - 后端：
3. （前端/后端）
   - 前端：
   - 后端：
