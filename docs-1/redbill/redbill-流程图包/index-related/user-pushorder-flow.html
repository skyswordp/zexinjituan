<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·æ¨å•å®Œæ•´æµç¨‹</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 34px; margin-bottom: 8px; }
        .header p { font-size: 14px; opacity: 0.9; }
        .card {
            background: white;
            border-radius: 10px;
            padding: 22px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            margin-bottom: 20px;
        }
        .card h3 { color: #333; font-size: 18px; margin-bottom: 10px; }
        .desc { color: #666; font-size: 14px; margin-bottom: 12px; }
        pre {
            background: #f7f7fb;
            padding: 16px;
            border-radius: 8px;
            overflow: auto;
            font-size: 12px;
            line-height: 1.6;
        }
        .mermaid { max-width: 794px; margin: 0 auto; }
        .mermaid svg { max-width: 100%; height: auto; }
        @page { size: A4 portrait; margin: 12mm; }
        @media print {
            body { background: white; padding: 0; }
            .container { max-width: 794px; }
            .card { padding: 16px; box-shadow: none; }
        }
        ol { padding-left: 18px; color: #444; line-height: 1.8; font-size: 14px; }
        a { color: #667eea; text-decoration: none; font-weight: bold; }
        .footer { text-align: center; margin-top: 30px; color: white; opacity: 0.8; font-size: 12px; }

        .mermaid { max-width: 100%; }
        .mermaid svg { max-width: 100%; height: auto; }

        @page { size: A4 landscape; margin: 12mm; }

        @media print {
            body { background: white; padding: 0; }
            .container { max-width: 1120px; }
            .card { padding: 16px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§­ ç”¨æˆ·æ¨å•å®Œæ•´æµç¨‹</h1>
            <p>ä»£ç  â†’ Mermaid â†’ HTML è¯´æ˜</p>
        </div>

        <div class="card">
            <h3>1) ä»£ç è§†å›¾ï¼ˆæœåŠ¡è°ƒç”¨é“¾ï¼‰</h3>
            <p class="desc">å¯¹åº” dc-api-friend ç”¨æˆ·ä¾§æ¥å£ä¸æœåŠ¡é“¾è·¯</p>
            <pre>// ç”¨æˆ·ç«¯ï¼šæŸ¥è¯¢æ¨å•åˆ—è¡¨
POST /api/friend/pushOrder/external/1.0/selectPushOrderList
  -> PushOrderExternalContoller.selectPushOrderList()
  -> IMasterPushOrderContentManagementService.queryPublishedList()
  -> DB: master_push_order_content_management

// ç”¨æˆ·ç«¯ï¼šæŸ¥çœ‹æ¨å•è¯¦æƒ…
POST /api/friend/pushOrder/external/1.0/selectPushOrderDetail
  -> PushOrderExternalContoller.selectPushOrderDetail()
  -> IMasterPushOrderContentManagementService.queryDetail()
  -> DB: master_push_order_content_management

// ç”¨æˆ·ç«¯ï¼šè´­ä¹°æ¨å•
POST /api/friend/pushOrder/external/1.0/purchasePushOrder
  -> PushOrderExternalContoller.purchasePushOrder()
  -> IMasterUserService.createPurchaseOrder()
  -> DB: master_push_order_purchase_record
  -> å†…éƒ¨å¯¹è´¦ï¼š/api/friend/pushOrder/inside/1.0/purchasePlanReceive
     -> PushOrderInsideContoller.purchasePlanReceive()
     -> insideVerification()  // å†…éƒ¨ç­¾åæ ¡éªŒ
     -> IMasterUserService.confirmPayment()
     -> DB: master_push_order_purchase_record (status=PAID)
</pre>
        </div>

        <div class="card">
            <h3>2) Mermaid æµç¨‹å›¾</h3>
            <p class="desc">ç”¨æˆ·æµè§ˆ â†’ è´­ä¹° â†’ å†…éƒ¨æ”¯ä»˜ç¡®è®¤ â†’ è§£é”å†…å®¹</p>
            <div class="mermaid">
flowchart TD
    A[ç”¨æˆ·æ‰“å¼€APP/å°ç¨‹åº] --> B[æŸ¥è¯¢æ¨å•åˆ—è¡¨\nexternal/selectPushOrderList]
    B --> C[æŸ¥çœ‹æ¨å•è¯¦æƒ…\nexternal/selectPushOrderDetail]
    C --> D{æ˜¯å¦è´­ä¹°}
    D -- å¦ --> E[ä»…å±•ç¤ºå…¬å¼€ä¿¡æ¯]
    D -- æ˜¯ --> F[åˆ›å»ºè´­ä¹°å•\nexternal/purchasePushOrder]
    F --> G[å†™å…¥è´­ä¹°è®°å½•\nmaster_push_order_purchase_record]
    G --> H[å†…éƒ¨æ”¯ä»˜ç¡®è®¤\ninside/purchasePlanReceive]
    H --> I{ç­¾åæ ¡éªŒ}
    I -- å¤±è´¥ --> J[è¿”å›é”™è¯¯\nå†…éƒ¨éªŒè¯å¤±è´¥]
    I -- æˆåŠŸ --> K[æ›´æ–°è®¢å•çŠ¶æ€=PAID]
    K --> L[è§£é”æ¨å•å†…å®¹]
    L --> M[ç”¨æˆ·æŸ¥çœ‹å®Œæ•´æ¨å•]
            </div>
        </div>

        <div class="card">
            <h3>3) HTML è§†å›¾ï¼ˆæ­¥éª¤è¯´æ˜ï¼‰</h3>
            <p class="desc">æŒ‰ç”¨æˆ·è¡Œä¸ºé¡ºåºæè¿°æ ¸å¿ƒèŠ‚ç‚¹</p>
            <ol>
                <li>ç”¨æˆ·è¿›å…¥åº”ç”¨ï¼Œè°ƒç”¨ <strong>external/selectPushOrderList</strong> è·å–æ¨å•åˆ—è¡¨ã€‚</li>
                <li>ç”¨æˆ·æŸ¥çœ‹æŸæ¡æ¨å•è¯¦æƒ…ï¼Œè°ƒç”¨ <strong>external/selectPushOrderDetail</strong>ã€‚</li>
                <li>è‹¥éœ€è¦è§£é”å†…å®¹ï¼Œè°ƒç”¨ <strong>external/purchasePushOrder</strong> åˆ›å»ºè´­ä¹°è®°å½•ã€‚</li>
                <li>å†…éƒ¨ç³»ç»Ÿé€šè¿‡ <strong>inside/purchasePlanReceive</strong> è¿›è¡Œæ”¯ä»˜ç¡®è®¤ä¸ç­¾åæ ¡éªŒã€‚</li>
                <li>ç¡®è®¤æˆåŠŸåæ›´æ–°è®¢å•çŠ¶æ€ä¸º <strong>PAID</strong>ï¼Œç”¨æˆ·å¯æŸ¥çœ‹å®Œæ•´æ¨å•å†…å®¹ã€‚</li>
            </ol>
        </div>

        <div class="footer">
            <p>è¿”å›ç´¢å¼•ï¼š<a href="index.html">çº¢å•å®Œæ•´åŠŸèƒ½æµç¨‹å›¾ç´¢å¼•</a></p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: "default",
            flowchart: { useMaxWidth: true }
        });
    </script>
</body>
</html>
