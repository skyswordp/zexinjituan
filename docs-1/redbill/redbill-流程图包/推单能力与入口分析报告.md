# 红单推单能力与入口分析报告

> 结论基于本目录内的已有文档：
> - 红单功能统计报告
> - 红单定时任务和数据交互报告
> - 任务流程图（task-01/02/03/05）

## 1. App/H5 端是否具备推单能力
**结论：具备手动推单能力！**
- App/H5 端**支持用户手动发布推单**：
  - 接口：`POST /api/friend/pushOrder/external/1.0/releasePushOrderContent`
  - 位置：`DC-API-2018/dc-api/dc-api-friend/src/main/java/com/dc/it/controller/PushOrderExternalContoller.java`
  - 功能：用户手动填写推单内容并发布（非 AI 自动生成）
- App/H5 端同时有"查询/展示类"接口：
  - 查询大师列表、排行榜、方案详情、大师详情等
  - 我的推单记录、我的购买、赛事优选等

**参考要点：**
- **写操作**：手动发布推单内容（releasePushOrderContent）
- **读操作**：查询展示已发布内容（在 PushOrderExternalContoller 和 PushOrderPublicController 中）

## 2. 红单系统的核心产品是否就是“推单”
**结论：是的。**
- 功能统计报告将红单功能明确为 PushOrder/推单模块。
- 业务链路核心为：创建 → 生成 → 发布 → 展示。
- 核心数据流与定时任务均围绕“推单内容生成与发布”。

## 3. 推单入口总览（按“生成/创建”维度）
**合计 7 个主要入口（4 个定时 + 2 个后台手动 + 1 个 App 手动）。**

### 3.1 定时任务入口（4个）
1. **真实玩家推单（20:00）**
   - 任务：`aiRealPushOrder`
   - 特点：半AI模式（真实用户历史注单 + AI分析）
   - 输出：生成“真实推单”内容

2. **全AI推单（21:00）**
   - 任务：`aiPushOrder`
   - 特点：全AI生成（赛事 + 赔率 + 历史数据）
   - 输出：常规推单内容

3. **AI补救推单（23:00）**
   - 任务：`aiRepairPushOrder`
   - 触发条件：当日推单失败或为空时补救
   - 输出：补救型推单内容

4. **AI补单（00:00:01）**
   - 任务：`aiRestockPushOrder`
   - 触发条件：联赛限制用户缺失推单时补齐
   - 输出：补单型推单内容

### 3.2 后台手动入口（2个）
5. **后台手动创建推单**
   - 接口：`POST /api/friend/pushOrder/aiUser/backPushOrder`
   - 作用：手动触发推单生成（不等定时）

6. **后台手动创建补单**
   - 接口：`POST /api/friend/pushOrder/aiUser/backRestockPushOrder`
   - 作用：手动触发补单生成（针对特定联赛）
### 3.3 App/H5 手动入口（1个）
7. **App 用户手动发布推单**
   - 接口：`POST /api/friend/pushOrder/external/1.0/releasePushOrderContent`
   - 位置：dc-api-friend 模块
   - 作用：用户在 App/H5 端手动填写并发布推单内容
   - 特点：无需 AI，直接提交推单内容
> 备注：后台还有“推单内容新增/更新”接口，但这些更多是**内容管理**入口（编辑/发布），不是“自动生成推单”的入口。

## 4. 每个入口“怎么推”的简要流程
### 4.1 定时任务（自动生成）
**共性流程：**
- 获取系统产品配置（PUSHORDER_PRODUCT）
- 查询可用推单用户（全AI/半AI）
- 拉取未来 2 天内赛事 + 赔率
- 调用 AI 生成内容
- 保存到推单内容表，状态通常为“未发布”

**差异点：**
- 真实推单：基于真实注单历史 + AI分析
- 补救推单：在当日失败时补偿
- 补单：仅针对联赛限制用户进行缺口补齐

### 4.2 后台手动入口
- 由运营人员在后台触发
- 实际调用逻辑与定时任务一致（调用 IAIPushOrderService）
- 常用于“立即生成/修复”

### 4.3 App/H5 手动入口
- 由 App/H5 端用户手动填写推单内容
- 直接提交赛事信息、分析内容等字段
- 保存到推单内容表，由发布者决定状态
- 无需 AI 生成，完全人工编辑

## 5. 结论摘要（最短版）
- **App/H5 端具备手动推单能力（releasePushOrderContent），同时支持查询展示。**
- **红单系统核心产品即"推单"。**
- **推单入口共 7 个：4 个定时任务 + 2 个后台手动触发 + 1 个 App 手动发布。**

---

如需进一步补充“发布入口（updateState/insert）”或“推单展示入口（客户端接口）”，可在本报告基础上扩展。