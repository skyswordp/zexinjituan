# ğŸ¯ Friend æ¨¡å—ä¸€ä½“åŒ–æµ‹è¯•æŒ‡å—

## æ¦‚è¿°

è¿™æ˜¯ä¸€å¥—å®Œæ•´çš„ **è‡ªåŠ¨åŒ–å¯åŠ¨å’Œæµ‹è¯•ç³»ç»Ÿ**ï¼Œèƒ½å¤Ÿä¸€æ¡é¾™å¼åœ°ï¼š
1. âœ… è‡ªåŠ¨ç¼–è¯‘ dc-api-friend æ¨¡å—
2. âœ… å¯åŠ¨ Friend å¾®æœåŠ¡
3. âœ… è¿è¡Œ API æµ‹è¯•
4. âœ… è‡ªåŠ¨è¯Šæ–­å’Œå±•ç¤ºé”™è¯¯

---

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä¸€é”®å¯åŠ¨æµ‹è¯•ï¼ˆæ¨èï¼‰

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd C:\Users\DEVTrump\projects

# è¿è¡Œä¸€ä½“åŒ–è„šæœ¬
python run_friend_integration.py
```

**è¯¥è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š**
- âœ… æ£€æŸ¥ Javaã€Mavenã€Python ç¯å¢ƒ
- âœ… ç¼–è¯‘æ•´ä¸ª DC-API-2018 é¡¹ç›®
- âœ… ç¼–è¯‘ dc-api-friend æ¨¡å—
- âœ… å¯åŠ¨ Friend æœåŠ¡ï¼ˆH2 æœ¬åœ°æ•°æ®åº“ï¼‰
- âœ… ç­‰å¾…æœåŠ¡å¯åŠ¨å®Œæˆ
- âœ… è¿è¡Œ API æµ‹è¯•å¥—ä»¶
- âœ… ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

---

### æ–¹å¼äºŒï¼šåˆ†æ­¥æ“ä½œ

å¦‚æœéœ€è¦æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œå¯ä»¥åˆ†æ­¥æ“ä½œï¼š

#### 1ï¸âƒ£ ç¼–è¯‘é¡¹ç›®
```bash
cd C:\Users\DEVTrump\projects\DC-Workspace\DC-API-2018

# ç¼–è¯‘æ•´ä¸ªé¡¹ç›®
mvn clean install -DskipTests

# æˆ–è€…åªç¼–è¯‘ Friend æ¨¡å—
cd dc-api/dc-api-friend
mvn clean package -DskipTests
```

#### 2ï¸âƒ£ å¯åŠ¨ Friend æœåŠ¡
```bash
# ä½¿ç”¨ H2 æœ¬åœ°æ•°æ®åº“å¯åŠ¨ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
java -Dspring.profiles.active=local -Dserver.port=8081 \
     -jar C:\Users\DEVTrump\projects\DC-Workspace\DC-API-2018\dc-api\dc-api-friend\target\dc-api-friend-*.jar
```

#### 3ï¸âƒ£ è¿è¡Œæµ‹è¯•
```bash
# æœ¬åœ°æµ‹è¯•æ¨¡å¼
python test_api_local.py

# æˆ–è‡ªå®šä¹‰ URL
python test_api_local.py --url http://localhost:8081
```

---

## è„šæœ¬è¯¦è§£

### `run_friend_integration.py` - ä¸€ä½“åŒ–å¯åŠ¨è„šæœ¬

**åŠŸèƒ½ï¼š** å…¨è‡ªåŠ¨çš„ç¼–è¯‘ã€å¯åŠ¨ã€æµ‹è¯•æµç¨‹

**ä½¿ç”¨æ–¹å¼ï¼š**
```bash
# åŸºç¡€ç”¨æ³•ï¼ˆé»˜è®¤å‚æ•°ï¼‰
python run_friend_integration.py

# è·³è¿‡ç¼–è¯‘ï¼Œç›´æ¥ç”¨ä¹‹å‰ç¼–è¯‘å¥½çš„ JAR
python run_friend_integration.py --skip-build

# æŒ‡å®šæœåŠ¡ç«¯å£
python run_friend_integration.py --port 9090

# æŒ‡å®šæµ‹è¯• URLï¼ˆå¦‚æœä¸æ˜¯æœ¬åœ°ï¼‰
python run_friend_integration.py --test-url http://192.168.1.100:8081

# ç¦ç”¨å½©è‰²è¾“å‡ºï¼ˆä¾¿äºæ—¥å¿—è®°å½•ï¼‰
python run_friend_integration.py --no-color
```

**å‘½ä»¤è¡Œå‚æ•°ï¼š**
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--skip-build` | è·³è¿‡ç¼–è¯‘æ­¥éª¤ | false |
| `--port` | Friend æœåŠ¡ç«¯å£ | 8081 |
| `--test-url` | æµ‹è¯•åŸºç¡€ URL | http://localhost:PORT |
| `--no-color` | ç¦ç”¨å½©è‰²è¾“å‡º | false |

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
================================================================================
ğŸ¯ Friend æ¨¡å—ä¸€ä½“åŒ–å¯åŠ¨å’Œæµ‹è¯•
================================================================================
å·¥ä½œç©ºé—´: C:\Users\DEVTrump\projects
Friend æ¨¡å—: C:\Users\DEVTrump\projects\DC-Workspace\DC-API-2018\dc-api\dc-api-friend
æµ‹è¯•è„šæœ¬: C:\Users\DEVTrump\projects\docs-1\FriendController\test_api.py
================================================================================

ğŸ” æ£€æŸ¥å…ˆå†³æ¡ä»¶...
âœ“ Java ç¯å¢ƒå·²å®‰è£…
âœ“ Maven ç¯å¢ƒå·²å®‰è£…
âœ“ Python ç¯å¢ƒå·²å®‰è£…
âœ“ Git ç¯å¢ƒå·²å®‰è£…

ğŸ“¦ å¼€å§‹ç¼–è¯‘ dc-api-friend æ¨¡å—...
âœ“ Friend æ¨¡å—ç¼–è¯‘æˆåŠŸ

ğŸš€ å¯åŠ¨ Friend æœåŠ¡ (ç«¯å£: 8081)...
âœ“ Friend æœåŠ¡è¿›ç¨‹å·²å¯åŠ¨ (PID: 1234)

â³ ç­‰å¾… Friend æœåŠ¡å¯åŠ¨ (æœ€å¤š 60 ç§’)...
âœ“ Friend æœåŠ¡å·²å¯åŠ¨å°±ç»ª

ğŸ§ª è¿è¡Œæµ‹è¯•è„šæœ¬...
ğŸ“‹ æµ‹è¯•è¾“å‡º:
[1/21] getUser ... âœ… 200
[2/21] getMyPraiseCount ... âœ… 200
[3/21] update ... âœ… 200
...

ğŸ“Š æµ‹è¯•æ±‡æ€»
âœ… å…¨éƒ¨æµ‹è¯•é€šè¿‡
================================================================================
```

---

### `test_api_local.py` - æœ¬åœ°å¼€å‘æµ‹è¯•è„šæœ¬

**åŠŸèƒ½ï¼š** çµæ´»çš„ API æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹ç¯å¢ƒ

**ä½¿ç”¨æ–¹å¼ï¼š**
```bash
# æœ¬åœ°æ¨¡å¼ï¼ˆlocalhost:8081ï¼‰- æ¨èæœ¬åœ°å¼€å‘
python test_api_local.py

# è¿œç¨‹æ¨¡å¼ï¼ˆe68web01.itomtest.comï¼‰- éœ€è¦ VPN
python test_api_local.py --remote

# è‡ªå®šä¹‰ URL
python test_api_local.py --url http://192.168.1.100:8081

# è‡ªå®šä¹‰ç«¯å£
python test_api_local.py --port 9090

# ä¸æ˜¾ç¤ºè¯¦ç»†ç»“æœï¼ˆåªæ˜¾ç¤ºæ±‡æ€»ï¼‰
python test_api_local.py --no-details
```

**å‘½ä»¤è¡Œå‚æ•°ï¼š**
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--remote` | è¿æ¥åˆ°è¿œç¨‹æµ‹è¯•ç¯å¢ƒ | false |
| `--url` | è‡ªå®šä¹‰åŸºç¡€ URL | - |
| `--port` | æœ¬åœ°ç«¯å£ï¼ˆä»…åœ¨ --remote æœªæŒ‡å®šæ—¶ï¼‰ | 8081 |
| `--no-details` | ä¸æ˜¾ç¤ºè¯¦ç»†ç»“æœ | false |

**æµ‹è¯•è¦†ç›–èŒƒå›´ï¼š**
- âœ… ç”¨æˆ·ç®¡ç† (getUser, update, saveFollow ç­‰)
- âœ… ç‚¹èµç³»ç»Ÿ (saveChangePraise, getMyPraiseCount)
- âœ… æœ‹å‹åœˆ (saveCircle, pageList, è¯„è®º, åˆ†äº«)
- âœ… æ£‹ç›˜ (board-index, board-guess)
- âœ… è¯é¢˜ (queryTitle, queryDetails)
- âœ… ä»»åŠ¡ç³»ç»Ÿ (queryTasks)
- âœ… ä¸¾æŠ¥ç³»ç»Ÿ (saveReport)

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘                  ğŸ¯ FriendController API æœ¬åœ°å¼€å‘æµ‹è¯•                     â•‘
â•‘                 æ¨¡å¼: LOCAL | åœ°å€: http://localhost:8081                 â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â³ æ£€æŸ¥è¿æ¥ http://localhost:8081 ...
âœ… è¿æ¥æˆåŠŸ

================================================================================
ğŸš€ FriendController API æµ‹è¯•æ‰§è¡Œ
ğŸ“ æ¨¡å¼: LOCAL | åœ°å€: http://localhost:8081
â° æ—¶é—´: 2025-01-29 14:30:45
================================================================================

[ 1/21] 1. getUser ... âœ… 200
[ 2/21] 2. getMyPraiseCount ... âœ… 200
[ 3/21] 3. update ... âœ… 200
...
[21/21] 21. saveReport ... âœ… 200

====================================================================================================
ğŸ“Š æµ‹è¯•æ±‡æ€»
====================================================================================================
åºå·   APIåç§°                    çŠ¶æ€       HTTP   å“åº”ç      è€—æ—¶
----------------------------------------------------------------------------------------------------
1     1. getUser                 âœ…         200    10000      45ms
2     2. getMyPraiseCount        âœ…         200    10000      32ms
...
----------------------------------------------------------------------------------------------------

æ€»è®¡: 21 | âœ… é€šè¿‡: 21 | âŒ å¤±è´¥: 0 | æˆåŠŸç‡: 100.0%

è€—æ—¶ç»Ÿè®¡: æ€»è®¡ 856ms | å¹³å‡ 40ms | æœ€å¿« 28ms | æœ€æ…¢ 124ms
====================================================================================================
```

---

## æ—¥å¿—æ–‡ä»¶ä½ç½®

æ‰€æœ‰è¿è¡Œæ—¥å¿—éƒ½ä¼šä¿å­˜åˆ°ï¼š
```
C:\Users\DEVTrump\projects\logs\
```

- **é›†æˆæµ‹è¯•æ—¥å¿—ï¼š** `integration_YYYYMMDD_HHMMSS.log`
- **API æµ‹è¯•æ—¥å¿—ï¼š** `api_test_YYYYMMDD_HHMMSS.log`

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### âŒ é—®é¢˜ï¼šç¼–è¯‘å¤±è´¥ "Maven command not found"

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥ Maven æ˜¯å¦å®‰è£…
mvn -version

# å¦‚æœæ²¡æœ‰ï¼Œéœ€è¦å®‰è£… Maven
# æˆ–ç¡®ä¿ Maven bin ç›®å½•åœ¨ PATH ç¯å¢ƒå˜é‡ä¸­
```

### âŒ é—®é¢˜ï¼šå¯åŠ¨æœåŠ¡å¤±è´¥ "Cannot connect to database"

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æœ¬åœ°å¼€å‘æ¨¡å¼å·²ä½¿ç”¨ H2 å†…å­˜æ•°æ®åº“ï¼Œä¸éœ€è¦å¤–éƒ¨æ•°æ®åº“è¿æ¥
# å¦‚æœä»ç„¶å¤±è´¥ï¼Œæ£€æŸ¥ï¼š
1. æ˜¯å¦æœ‰ç«¯å£å†²çªï¼ˆå·²æœ‰æœåŠ¡åœ¨ 8081 ç«¯å£ï¼‰
2. Java ç‰ˆæœ¬æ˜¯å¦å…¼å®¹ï¼ˆæ¨è Java 8 æˆ–ä»¥ä¸Šï¼‰
3. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
```

### âŒ é—®é¢˜ï¼šæµ‹è¯•å¤±è´¥ "Connection refused"

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ç¡®è®¤ Friend æœåŠ¡å·²å¯åŠ¨
# æ£€æŸ¥æœåŠ¡æ˜¯å¦çœŸçš„åœ¨è¿è¡Œ
netstat -ano | findstr "8081"

# å¦‚æœæ²¡æœ‰ï¼Œè¿”å›é‡æ–°å¯åŠ¨æœåŠ¡
# å¦‚æœæœ‰ï¼Œæ£€æŸ¥é˜²ç«å¢™è®¾ç½®
```

### âŒ é—®é¢˜ï¼šPython ç¯å¢ƒé—®é¢˜ "Module 'requests' not found"

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# å®‰è£…ä¾èµ–
pip install requests

# æˆ–æŒ‡å®š Python ç‰ˆæœ¬
python -m pip install requests
```

---

## å·¥ä½œæµå»ºè®®

### æ—¥å¸¸å¼€å‘æµç¨‹

1. **å¯åŠ¨ä¸€ä½“åŒ–è„šæœ¬**
   ```bash
   python run_friend_integration.py --skip-build
   ```
   ï¼ˆå¦‚æœä¹‹å‰å·²ç»ç¼–è¯‘è¿‡ï¼Œä½¿ç”¨ `--skip-build` åŠ é€Ÿï¼‰

2. **ä¿®æ”¹ä»£ç **
   - ç¼–è¾‘ FriendController.java æˆ–å…¶ä»–æºä»£ç 
   - ä¿®æ”¹ä¸šåŠ¡é€»è¾‘æˆ–æ·»åŠ æ–°æ¥å£

3. **é‡æ–°ç¼–è¯‘å’Œæµ‹è¯•**
   ```bash
   python run_friend_integration.py
   ```
   ï¼ˆä¸ä½¿ç”¨ `--skip-build`ï¼Œé‡æ–°ç¼–è¯‘ï¼‰

4. **æ£€æŸ¥æ—¥å¿—**
   - æ‰“å¼€ `logs/` ç›®å½•ä¸‹çš„æœ€æ–°æ—¥å¿—æ–‡ä»¶
   - æŸ¥çœ‹è¯¦ç»†çš„æµ‹è¯•ç»“æœå’Œé”™è¯¯ä¿¡æ¯

### è¿œç¨‹æµ‹è¯•æµç¨‹ï¼ˆéœ€è¦ VPNï¼‰

```bash
# 1. è¿æ¥ VPN
# https://18.166.253.125:943/

# 2. è¿è¡Œè¿œç¨‹æµ‹è¯•
python test_api_local.py --remote

# 3. æŸ¥çœ‹æµ‹è¯•ç»“æœ
```

---

## è„šæœ¬ä¿®æ”¹å’Œæ‰©å±•

### æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹

ç¼–è¾‘ `test_api_local.py` ä¸­çš„ `_init_tests()` æ–¹æ³•ï¼š

```python
def _init_tests(self):
    """åˆå§‹åŒ–æµ‹è¯•ç”¨ä¾‹"""
    self.tests = [
        # ç°æœ‰çš„æµ‹è¯•...
        
        # æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹
        {
            'name': '22. æ–°æ¥å£åç§°',
            'path': '/api/friend/path/to/new/endpoint',
            'body': {'param1': 'value1', 'param2': 'value2'}
        },
    ]
```

### ä¿®æ”¹æµ‹è¯•æ•°æ®

ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ä¸­çš„ `body` å‚æ•°ä»¥æµ‹è¯•ä¸åŒçš„æ•°æ®åœºæ™¯ã€‚

### è‡ªå®šä¹‰å¯åŠ¨å‚æ•°

ç¼–è¾‘ `run_friend_integration.py` ä¸­çš„é…ç½®éƒ¨åˆ†ï¼š

```python
# é…ç½®
WORKSPACE_ROOT = r'C:\Users\DEVTrump\projects'
FRIEND_MODULE_PATH = os.path.join(...)  # ä¿®æ”¹æ¨¡å—è·¯å¾„
# ç­‰...
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ä½¿ç”¨ `--skip-build` åŠ é€Ÿå¯åŠ¨**
   ```bash
   python run_friend_integration.py --skip-build
   ```
   ï¼ˆé€‚ç”¨äºä»£ç æœªæ”¹åŠ¨çš„æƒ…å†µï¼‰

2. **åªè¿è¡Œéƒ¨åˆ†æµ‹è¯•**
   ä¿®æ”¹ `test_api_local.py` ä¸­çš„ `_init_tests()` æ–¹æ³•ï¼Œæ³¨é‡Šæ‰ä¸éœ€è¦çš„æµ‹è¯•

3. **å¢åŠ è¶…æ—¶æ—¶é—´**
   å¦‚æœç½‘ç»œè¾ƒæ…¢ï¼Œå¯ä»¥åœ¨è„šæœ¬ä¸­å¢åŠ  timeout å‚æ•°

---

## ç›¸å…³æ–‡ä»¶ä½ç½®

```
C:\Users\DEVTrump\projects\
â”œâ”€â”€ run_friend_integration.py          # ä¸€ä½“åŒ–å¯åŠ¨è„šæœ¬ â­
â”œâ”€â”€ test_api_local.py                  # æœ¬åœ°å¼€å‘æµ‹è¯•è„šæœ¬ â­
â”œâ”€â”€ DC-Workspace/
â”‚   â””â”€â”€ DC-API-2018/
â”‚       â”œâ”€â”€ dc-api/
â”‚       â”‚   â””â”€â”€ dc-api-friend/         # Friend å¾®æœåŠ¡æ¨¡å—
â”‚       â””â”€â”€ dc-api-web/
â”‚           â””â”€â”€ src/main/java/.../
â”‚               â””â”€â”€ FriendController.java  # ç½‘å…³å±‚æ§åˆ¶å™¨
â”œâ”€â”€ docs-1/
â”‚   â””â”€â”€ FriendController/
â”‚       â””â”€â”€ test_api.py                # åŸå§‹æµ‹è¯•è„šæœ¬ï¼ˆä»…ä¾›å‚è€ƒï¼‰
â””â”€â”€ logs/
    â”œâ”€â”€ integration_*.log              # é›†æˆæµ‹è¯•æ—¥å¿—
    â””â”€â”€ api_test_*.log                 # API æµ‹è¯•æ—¥å¿—
```

---

## æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶ï¼š** Spring Boot + MyBatis
- **æ•°æ®åº“ï¼š** H2ï¼ˆæœ¬åœ°å¼€å‘ï¼‰/ Oracleï¼ˆç”Ÿäº§ï¼‰
- **æ„å»ºå·¥å…·ï¼š** Maven
- **æµ‹è¯•å·¥å…·ï¼š** Python requests åº“
- **æ—¥å¿—ï¼š** è¯¦ç»†çš„æ–‡æœ¬æ—¥å¿—è¾“å‡º

---

## è”ç³»å’Œåé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–æ”¹è¿›å»ºè®®ï¼Œè¯·ï¼š
1. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æŸ¥é˜… [Friend å¼€å‘æŒ‡å—](DC-Workspace/docs/FRIEND-LOCAL-DEVELOPMENT-GUIDE.md)
3. æŸ¥é˜… [æœ¬åœ°è°ƒè¯•æŒ‡å—](DC-Workspace/LOCAL-DEBUG-GUIDE.md)

---

*æœ€åæ›´æ–°: 2025-01-29*
