# 红单功能统计报告

## 概览
红单功能（PushOrder/推单）是一个完整的后端功能模块，主要用于管理体育赛事的推单信息、AI推单用户管理等功能。

---

## Controller 统计

### 一、Red单相关Controller数量：**7个**

| 序号 | Controller名称 | 位置 | 说明 |
|-----|--------------|------|------|
| 1 | PushOrderAiUserController | `/api/friend/pushOrder/aiUser` | 推单AI用户管理 |
| 2 | PushOrderContentManagementController | `/api/friend/pushOrder/contentManagement` | 推单内容管理 |
| 3 | PushOrderContentGeneralLogController | `/api/friend/pushOrder/contentGeneralLog` | 推单内容通用日志 |
| 4 | PushOrderParamConfigController | `/api/friend/pushOrder/paramConfig` | 推单参数配置 |
| 5 | PushOrderLevelTitleConfigController | `/api/friend/pushOrder/levelTitleConfig` | 推单等级称号配置 |
| 6 | PushOrderPermissionRecordController | `/api/friend/pushOrder/permissionRecord` | 推单权限记录 |
| 7 | PushOrderPublicController | `/api/public/pushOrder` | 红单对外系统接口（无需登录） |

---

## 接口统计

### 二、总接口数量：**44个**

#### 细节分布：

| Controller | 接口数 | 占比 |
|-----------|--------|------|
| PushOrderAiUserController | 15 | 34.1% |
| PushOrderContentManagementController | 12 | 27.3% |
| PushOrderPublicController | 7 | 15.9% |
| PushOrderLevelTitleConfigController | 4 | 9.1% |
| PushOrderParamConfigController | 3 | 6.8% |
| PushOrderContentGeneralLogController | 2 | 4.5% |
| PushOrderPermissionRecordController | 1 | 2.3% |

---

## 主要功能模块

### 1. 推单AI用户管理（15个接口）
**关键接口：**
- `/leagueList` - 联赛列表查询
- `/testAi` - AI测试接口
- `/backPushOrder` - 后台推单创建
- `/backRestockPushOrder` - 后台补单
- `/list` - 推单AI用户列表（分页）
- `/checkPlayers` - 检查推单用户
- `/checkAIUser` - 检查AI用户
- `/save` - 新增AI用户
- `/update` - 更新AI用户
- `/del` - 删除AI用户
- `/updateGrantKf` - 更新授权客服
- `/findGrantKf` - 查询授权客服
- `/queryHalfAIApplyProduct` - 查询半AI应用产品
- `/saveHalfAI` - 保存半AI配置
- `/updateHalfAI` - 更新半AI配置

### 2. 推单内容管理（12个接口）
**关键接口：**
- `/pageList` - 推单内容列表（分页）
- `/pageListOne` - 推单内容单页查询
- `/insert` - 新增推单内容
- `/update` - 更新推单内容
- `/updateState` - 更新推单状态
- `/openPushOrderData` - 对外开放推单数据查询
- `/findDetectingUsername` - 查询审核用户名
- `/findGeneralLogPageList` - 查询日志列表
- `/updatePartialFields` - 更新部分字段
- `/findMatchFootBasketBall` - 查询足篮球赛事
- `/updateGrantKf` - 更新授权客服
- `/findGrantKf` - 查询授权客服

### 3. 红单对外系统接口（7个接口 - 无需登录）
**关键接口：**
- `/findPersonalInfoPageList` - 查询大师列表（按称号：足球大师/篮球大师）
- `/findMasterDetailed` - 查询大师详情
- `/findPushUserInfo` - 查询推单用户基本信息
- `/findMonthlyRankingPageList` - 查询月度排行榜（红单榜/连红榜/人气榜）
- `/findPlanDetailed` - 查询方案详情
- `/findProgrammePreferredPageList` - 查询偏好方案列表
- `/findMatchPreferredPageList` - 查询偏好赛事列表

### 4. 推单等级称号配置（4个接口）
**关键接口：**
- `/list` - 等级称号配置列表
- `/insert` - 新增等级称号
- `/update` - 更新等级称号
- `/findIdNameList` - 查询ID-名称列表

### 5. 推单参数配置（3个接口）
**关键接口：**
- `/list` - 参数配置列表
- `/update` - 更新参数配置
- `/findPushOrdersPrice` - 查询推单价格

### 6. 推单内容通用日志（2个接口）
**关键接口：**
- `/pageList` - 日志列表（分页）
- `/purchaseStatisticsPageList` - 购买统计列表

### 7. 推单权限记录（1个接口）
**关键接口：**
- `/pageList` - 权限记录列表

---

## 核心服务实现

### 相关Service类：
- `IAIPushOrderService` - AI推单服务接口
- `IAIService` - AI服务接口
- `IPushOrderAiUserService` - 推单AI用户服务
- `IMasterPushOrderContentManagementService` - 推单内容管理服务
- `IMasterPushOrderParamConfigService` - 推单参数配置服务
- `IMasterPushOrderRealOrderService` - 推单实单服务

### 相关DAO类：
- `PushOrderAiUserDao` - AI用户数据访问
- `PushOrderContentManagementDao` - 内容管理数据访问

---

## 数据模型

### 主要POJO类：
- `PushOrderAiUser` - 推单AI用户
- `PushOrderAiUserCopywrite` - 推单AI用户文案
- `PushOrderContentManagement` - 推单内容管理
- `PushOrderContentGeneralLog` - 推单内容通用日志

---

## 关键特性

### 1. 双AI模式
- **豆包AI**：0号AI类型
- **KIMI AI**：1号AI类型

### 2. 推单产品管理
- 系统参数 `PUSHORDER_PRODUCT` 配置可用的推单产品
- 当前产品代码示例：`at`, `yl` 等

### 3. 推单状态管理
- 0: 未发布
- 1: 已发布
- 2: 已完成
- 等其他状态标识

### 4. 权限管理
- 基于产品和操作用户的权限控制
- 支持客服授权管理

### 5. AI推单任务
- `taskCreatePushOrder()` - 定时创建推单
- `taskRestockPushOrder()` - 定时补单
- `taskRepairCreatePushOrder()` - 修复创建推单
- `taskCreateRealPushOrder()` - 创建真实推单

---

## 调用统计

### 从Friend模块调用
在 [FriendController.java](../dc-parent/dc-api-web/src/main/java/com/dc/it/controller/FriendController.java) 中有对推单的集成：
- 支持关注带推单ID参数：`saveFollowNew` 接口支持 `pushOrderId` 参数

---

## 部署位置

**模块路径：** `DC-API-2018/dc-api/dc-api-office`
**Controller包：** `com.dc.it.friend.controller`
**Service包：** `com.dc.it.friend.service`
**DAO包：** `com.dc.it.friend.dao`

---

## 总结

| 指标 | 数值 |
|------|------|
| **Controller数量** | 7个 |
| **API接口数量** | 44个 |
| **主要业务领域** | 推单内容管理、AI用户管理、对外发布 |
| **用户类型** | 后台操作员、AI推单用户、前端用户、公众 |

红单功能是一个相对独立且完整的子系统，涵盖了推单的整个生命周期：配置管理→AI用户管理→内容管理→对外发布→数据统计。
